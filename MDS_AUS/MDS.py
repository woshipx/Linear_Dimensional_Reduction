# -*- coding: utf-8 -*-
"""
Created on Tue Mar 31 12:35:38 2020

@author: xpanz
"""

import numpy as np
import matplotlib.pyplot as plt


def MDS(D,d):
    D = D**2
    
    print(D)
    totalMean = np.mean(D)
    columnMean = np.mean(D, axis = 0)
    rowMean = np.mean(D, axis = 1)
    B = np.zeros(D.shape)
    for i in range(B.shape[0]):
        for j in range(B.shape[1]):
            B[i][j] = -0.5 * (D[i][j] - rowMean[i] - columnMean[j] + totalMean)
    eigVal, eigVec = np.linalg.eig(B)#求特征值及特征向量
    #对特征值进行排序，得到排序索引
    eigValSorted_indices = np.argsort(eigVal)
    #提取d个最大特征向量
    topd_eigVec = eigVec[:,eigValSorted_indices[:-d-1:-1]] #-d-1前加:才能向左切
    X = np.dot(topd_eigVec, np.sqrt(np.diag(eigVal[:-d-1:-1])))
    return X



Latitude = np.array([35.3, 37.8, 33.9, 34.9, 32.0, 12.3, 27.4, 36, 20.3, 28, 42.8, 16.9])

D = np.array([[0,	467.374858548121,	247.608733183031,	956.886491788649,	3093.05148783038,	3154.38611347106,	954.136555114451,	213.711648364220,	3415.53283673283,	908.795301947746,	849.212900233340,	2074.28384705043],
[467.374858548121,	0,	714.973780344247,	650.365536401717,	2722.16226824580,	3165.79715629718,	1383.30889405789,	268.030943694640,	3196.73900274244,	1348.13955917424,	592.649086579277,	2328.24436041196],
[247.608733183031,	714.973780344247,	0,	1161.88823680611,	3297.30913632584,	3171.30081754511,	743.782709741746,	456.637801747494,	3546.92657849847,	689.490946718912,	1047.28467496668,	1967.86262213969],
[956.886491788649,	650.365536401717,	1161.88823680611,	0,	2137.40011370197,	2636.15067745816,	1603.36648825603,	762.319544988402,	2547.00849585095,	1599.16708157370,	1157.22937861018,	2127.76587059292],
[3093.05148783038,	2722.16226824580,	3297.30913632584,	2137.40011370197,	0,	2676.49581236578,	3615.59480318704,	2892.02220572823,	1331.97407331247,	3633.96233336443,	3011.41204473233,	3455.91470517064],
[3154.38611347106,	3165.79715629718,	3171.30081754511,	2636.15067745816,	2676.49581236578,	0,	2859.54162398139,	3093.59255557116,	1577.41717542471,	2928.27400263152,	3749.70285228954,	1694.28978084729],
[954.136555114451,	1383.30889405789,	743.782709741746,	1603.36648825603,	3615.59480318704,	2859.54162398139,	0,	1117.52761179118,	3578.31103246636,	77.5590378586357,	1790.04911075625,	1383.79480133124],
[213.711648364220,	268.030943694640,	456.637801747494,	762.319544988402,	2892.02220572823,	3093.59255557116,	1117.52761179118,	0,	3262.54064745303,	1080.82633081295,	757.751366324702,	2128.98112622238],
[3415.53283673283,	3196.73900274244,	3546.92657849847,	2547.00849585095,	1331.97407331247,	1577.41717542471,	3578.31103246636,	3262.54064745303,	0,	3624.00174414134,	3665.73386308575,	2891.25409202758],
[908.795301947746,	1348.13955917424,	689.490946718912,	1599.16708157370,	3633.96233336443,	2928.27400263152,	77.5590378586357,	1080.82633081295,	3624.00174414134,	0,	1736.75749191989,	1461.22474882319],
[849.212900233340,	592.649086579277,	1047.28467496668,	1157.22937861018,	3011.41204473233,	3749.70285228954,	1790.04911075625,	757.751366324702,	3665.73386308575,	1736.75749191989,	0,	2886.68563790319],
[2074.28384705043,	2328.24436041196,	1967.86262213969,	2127.76587059292,	3455.91470517064,	1694.28978084729,	1383.79480133124,	2128.98112622238,	2891.25409202758,	1461.22474882319,	2886.68563790319,	0]])

X = MDS(D,5)

plt.scatter(X[0:,0],X[0:,1],color='red')